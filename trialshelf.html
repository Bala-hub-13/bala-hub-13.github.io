<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <link rel="icon" type="image/x-icon" href="/assets/favicon.png">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bookshelf — Quite shelf</title>

  <!-- Fonts (match site) -->
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;600&family=DM+Sans:wght@400;500&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#070707;
      --card:#0f0f10;
      --muted:#9b9b9b;
      --accent:#e9dfcf; /* warm ivory */
      --glass: rgba(255,255,255,0.03);
      --radius:14px;
      --shadow: 0 6px 18px rgba(0,0,0,0.6);
    }
    html,body{height:100%;}
    body{
      margin:0;
      font-family:"DM Sans", system-ui, sans-serif;
      background:linear-gradient(180deg,#060606 0%, #0a0a0a 100%);
      color:var(--accent);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      justify-content:center;
      padding:48px 20px;
    }

    .container{
      width:100%;
      max-width:1100px;
      display:grid;
      grid-template-columns: 320px 1fr;
      gap:28px;
      align-items:start;
    }

    /* Left column: title + description */
    .meta{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border-radius:var(--radius);
      padding:28px;
      box-shadow:var(--shadow);
      min-height:220px;
      font-family:"EB Garamond", serif;
    }
    .meta h1{
      margin:0 0 8px 0;
      font-size:34px;
      letter-spacing:0.6px;
      color:var(--accent);
    }
    .meta p{color:var(--muted); margin:0; line-height:1.6; font-size:15px;}

    /* Right column: shelf UI */
    .shelf{
      display:grid;
      grid-template-rows:auto 1fr;
      gap:18px;
    }

    .controls{
      display:flex;
      gap:12px;
      align-items:center;
    }

    .add-form{
      background:var(--card);
      padding:12px;
      border-radius:12px;
      display:flex;
      gap:10px;
      align-items:center;
      box-shadow:0 4px 12px rgba(0,0,0,0.6);
    }
    .add-form input[type="text"]{
      flex:1;
      border:0;
      background:transparent;
      color:var(--accent);
      font-size:15px;
      outline:none;
      font-family:inherit;
    }
    .add-form select{
      background:transparent;
      color:var(--muted);
      border:1px solid rgba(255,255,255,0.04);
      padding:6px 8px;
      border-radius:8px;
      font-size:13px;
    }
    .btn{
      background: #ffffff11;
      color:var(--accent);
      border:1px solid rgba(255,255,255,0.03);
      padding:8px 12px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      transition:transform .12s ease, background .12s;
    }
    .btn:hover{ transform:translateY(-2px); background:#ffffff16; }

    /* Lists grid */
    .lists{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:16px;
      align-items:start;
    }

    .list{
      background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
      padding:14px;
      border-radius:12px;
      min-height:220px;
      box-shadow:var(--shadow);
    }
    .list h3{
      margin:0 0 12px 0;
      font-family:"EB Garamond", serif;
      color:var(--accent);
      font-size:18px;
    }
    .list small{ color:var(--muted); display:block; margin-bottom:10px; font-size:13px;}

    ul.book-list{ list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:10px; }
    li.book{
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:var(--glass);
      padding:10px 12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.02);
    }
    .book .meta{
      display:flex; flex-direction:column;
    }
    .book .title{ font-family:"EB Garamond", serif; color:var(--accent); font-size:14px; }
    .book .by{ color:var(--muted); font-size:13px; }

    .book .actions{ display:flex; gap:8px; align-items:center; }
    .icon-btn{ background:transparent; border:0; color:var(--muted); cursor:pointer; font-size:14px; padding:6px; border-radius:8px;}
    .icon-btn:hover{ color:var(--accent); background:#ffffff06; }

    /* empty state */
    .empty{ color:var(--muted); font-size:14px; padding:10px; }

    /* responsive */
    @media (max-width:900px){
      .container{ grid-template-columns: 1fr; }
      .lists{ grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container" role="main">
    <aside class="meta" aria-labelledby="shelf-title">
      <h1 id="shelf-title">Bookshelf</h1>
      <p>Small shelf of books: <strong>Read</strong>, <strong>Currently reading</strong>, and <strong>Will read</strong>. Add titles here and move them between stacks. This is private to your browser (saved locally).</p>
    </aside>

    <section class="shelf" aria-labelledby="shelf-desc">
      <div class="controls" id="shelf-desc">
        <form id="addForm" class="add-form" aria-label="Add a book">
          <input id="bookInput" type="text" placeholder="Title — Author (optional)" aria-label="Book title" required />
          <select id="bookCategory" aria-label="Category">
            <option value="will">Will read</option>
            <option value="current">Currently reading</option>
            <option value="read">Read</option>
          </select>
          <button class="btn" type="submit">Add</button>
        </form>
        <button class="btn" id="clearBtn" title="Reset shelf">Reset</button>
      </div>

      <div class="lists" aria-live="polite">
        <div class="list" id="will">
          <h3>Will read</h3>
          <small>Planned, queued, hoped-for</small>
          <ul class="book-list" id="will-list"></ul>
        </div>

        <div class="list" id="current">
          <h3>Currently reading</h3>
          <small>Active reads and slow-burns</small>
          <ul class="book-list" id="current-list"></ul>
        </div>

        <div class="list" id="read">
          <h3>Read</h3>
          <small>Completed, dog-eared, annotated</small>
          <ul class="book-list" id="read-list"></ul>
        </div>
      </div>
    </section>
  </div>

  <script>
    // Small bookshelf app (localStorage)
    const DEFAULT_BOOKS = {
      will: [
        { id: genId(), text: "The Poetics of Space — Gaston Bachelard" },
        { id: genId(), text: "Invisible Cities — Italo Calvino" }
      ],
      current: [
        { id: genId(), text: "Notes from Underground — Dostoevsky" }
      ],
      read: [
        { id: genId(), text: "On Beauty and Being Just — Elaine Scarry" }
      ]
    };

    function genId(){ return Math.random().toString(36).slice(2,9); }

    const STORAGE_KEY = "quietShelf.v1";
    const state = loadState();

    const willList = document.getElementById("will-list");
    const currentList = document.getElementById("current-list");
    const readList = document.getElementById("read-list");
    const addForm = document.getElementById("addForm");
    const bookInput = document.getElementById("bookInput");
    const bookCategory = document.getElementById("bookCategory");
    const clearBtn = document.getElementById("clearBtn");

    renderAll();

    addForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const text = bookInput.value.trim();
      if(!text) return;
      const cat = bookCategory.value;
      const item = { id: genId(), text };
      state[cat].unshift(item);
      saveState();
      renderAll();
      addForm.reset();
      bookInput.focus();
    });

    clearBtn.addEventListener("click", () => {
      if(!confirm("Reset bookshelf to defaults? This clears your local shelf.")) return;
      localStorage.removeItem(STORAGE_KEY);
      Object.assign(state, loadState(true));
      renderAll();
    });

    function loadState(defaults=false){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(defaults) return JSON.parse(JSON.stringify(DEFAULT_BOOKS));
      if(!raw) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(DEFAULT_BOOKS));
        return JSON.parse(JSON.stringify(DEFAULT_BOOKS));
      }
      try { return JSON.parse(raw); } catch { return JSON.parse(JSON.stringify(DEFAULT_BOOKS)); }
    }

    function saveState(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    function renderAll(){
      willList.innerHTML = "";
      currentList.innerHTML = "";
      readList.innerHTML = "";

      renderList(state.will, willList, "will");
      renderList(state.current, currentList, "current");
      renderList(state.read, readList, "read");

      // If empty show placeholder
      if(!state.will.length) willList.innerHTML = `<li class="empty">No planned books. Add one.</li>`;
      if(!state.current.length) currentList.innerHTML = `<li class="empty">Not reading anything right now.</li>`;
      if(!state.read.length) readList.innerHTML = `<li class="empty">Your finished shelf is empty.</li>`;
    }

    function renderList(items, container, bucket){
      for(const it of items){
        const li = document.createElement("li");
        li.className = "book";
        li.dataset.id = it.id;
        li.innerHTML = `
          <div class="meta">
            <div class="title">${escapeHtml(it.text.split("—")[0].trim())}</div>
            <div class="by">${escapeHtml(it.text.split("—").slice(1).join("—").trim())}</div>
          </div>
          <div class="actions" aria-hidden="true">
            ${bucket !== "will" ? `<button class="icon-btn" data-action="to-will" title="Move to Will read">→ Will</button>` : ""}
            ${bucket !== "current" ? `<button class="icon-btn" data-action="to-current" title="Move to Currently reading">→ Cur</button>` : ""}
            ${bucket !== "read" ? `<button class="icon-btn" data-action="to-read" title="Move to Read">→ Read</button>` : ""}
            <button class="icon-btn" data-action="delete" title="Remove">✕</button>
          </div>
        `;
        container.appendChild(li);
      }
    }

    // Event delegation for list actions
    document.querySelectorAll(".lists").forEach(listRegion => {
      listRegion.addEventListener("click", (e) => {
        const btn = e.target.closest("button");
        if(!btn) return;
        const li = e.target.closest("li.book");
        if(!li) return;
        const id = li.dataset.id;
        const action = btn.dataset.action;
        if(action === "delete"){ removeById(id); return; }
        if(action === "to-will"){ moveTo(id,"will"); return; }
        if(action === "to-current"){ moveTo(id,"current"); return; }
        if(action === "to-read"){ moveTo(id,"read"); return; }
      });
    });

    function removeById(id){
      for(const k of ["will","current","read"]){
        const idx = state[k].findIndex(x=>x.id===id);
        if(idx>=0){ state[k].splice(idx,1); saveState(); renderAll(); return; }
      }
    }
    function moveTo(id, target){
      for(const k of ["will","current","read"]){
        const idx = state[k].findIndex(x=>x.id===id);
        if(idx>=0){
          const [item] = state[k].splice(idx,1);
          state[target].unshift(item);
          saveState();
          renderAll();
          return;
        }
      }
    }

    function escapeHtml(s){ return s.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;"); }
  </script>
</body>
<footer>
  <nav>
    <p style="text-align:center; margin-top:2em;">
      <a href="Quite shelf.html"  style="color:#c66; text-decoration:none; font-style:italic; font-size:1em; opacity:0.8;">
    ← back to where you were</a>
    </p>
    </nav>
</footer>
</html>
